"use strict";(self.webpackChunkdev_test=self.webpackChunkdev_test||[]).push([[769],{3769:(ft,v,c)=>{c.r(v),c.d(v,{SubscriptionModule:()=>gt});var a=c(6895),_=c(2381),l=c(9751),h=c(9646),g=c(3900),f=c(4004),u=c(433);function Z(){return n=>{if(n.value){const i=n.value.toString(),e=/^4[0-9]{12}(?:[0-9]{3})?$/,r=i.replace(/ /g,"");if(!/^\d+$/.test(r))return{creditCardNumberInvalid:!0};if(!e.test(r))return{creditCardTypeInvalid:!0};if(![13,16].includes(i.length))return{creditCardNumberLengthInvalid:!0}}return null}}class T{constructor({number:i,expirationDate:e,cvv:r}){this.number=i,this.expirationDate=e,this.cvv=r}pay(i){return(0,h.of)(!0)}}class A{calculatePrice(i,e){return i.price_usd_per_gb*e.storage}}class w{applyDiscount(i){return.9*i}}class U{applyDiscount(i){return i}}var t=c(8256),P=c(1135),k=c(727);class I extends k.w0{constructor(i,e){super()}schedule(i,e=0){return this}}const m={setInterval(n,i,...e){const{delegate:r}=m;return r?.setInterval?r.setInterval(n,i,...e):setInterval(n,i,...e)},clearInterval(n){const{delegate:i}=m;return(i?.clearInterval||clearInterval)(n)},delegate:void 0};var q=c(8737);const S={now:()=>(S.delegate||Date).now(),delegate:void 0};class p{constructor(i,e=p.now){this.schedulerActionCtor=i,this.now=e}schedule(i,e=0,r){return new this.schedulerActionCtor(this,i).schedule(r,e)}}p.now=S.now;const y=new class D extends p{constructor(i,e=p.now){super(i,e),this.actions=[],this._active=!1}flush(i){const{actions:e}=this;if(this._active)return void e.push(i);let r;this._active=!0;do{if(r=i.execute(i.state,i.delay))break}while(i=e.shift());if(this._active=!1,r){for(;i=e.shift();)i.unsubscribe();throw r}}}(class J extends I{constructor(i,e){super(i,e),this.scheduler=i,this.work=e,this.pending=!1}schedule(i,e=0){var r;if(this.closed)return this;this.state=i;const o=this.id,s=this.scheduler;return null!=o&&(this.id=this.recycleAsyncId(s,o,e)),this.pending=!0,this.delay=e,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,e),this}requestAsyncId(i,e,r=0){return m.setInterval(i.flush.bind(i,this),r)}recycleAsyncId(i,e,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return e;null!=e&&m.clearInterval(e)}execute(i,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(i,e);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(i,e){let o,r=!1;try{this.work(i)}catch(s){r=!0,o=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:i,scheduler:e}=this,{actions:r}=e;this.work=this.state=this.scheduler=null,this.pending=!1,(0,q.P)(r,this),null!=i&&(this.id=this.recycleAsyncId(e,i,null)),this.delay=null,super.unsubscribe()}}}),N=y;var E=c(7272),x=c(5698),F=c(4482),O=c(5403),Q=c(5032),j=c(9718),$=c(5577),Y=c(8421);function C(n,i){return i?e=>(0,E.z)(i.pipe((0,x.q)(1),function M(){return(0,F.e)((n,i)=>{n.subscribe((0,O.x)(i,Q.Z))})}()),e.pipe(C(n))):(0,$.z)((e,r)=>(0,Y.Xf)(n(e,r)).pipe((0,x.q)(1),(0,j.h)(e)))}var B=c(3532);class V extends Error{constructor(i){super(`No subscription plan with duration ${i}`)}}let X=(()=>{class n{constructor(){}calculate(e,r,o,s){const d=o.calculatePrice(e,r);return s.applyDiscount(d)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),z=(()=>{class n{constructor(e){this.pricingService=e,this.subscriptionPlans=[{duration_months:3,price_usd_per_gb:3},{duration_months:6,price_usd_per_gb:2.5},{duration_months:12,price_usd_per_gb:2}],this.subcriptionOrderSubject$=new P.X({duration:12,storage:5,upfrontPayment:!1})}updateOrder(e){this.subcriptionOrderSubject$.next({...this.subcriptionOrderSubject$.value,...e})}currentOrder(){return this.subcriptionOrderSubject$}calculatePrice(e){const r=e.upfrontPayment?new w:new U,o=new A;return this.getSubscriptionPlan(e.duration).pipe((0,f.U)(s=>this.pricingService.calculate(s,e,o,r)))}processOrder(e,r){return this.calculatePrice(e).pipe((0,f.U)(o=>o),(0,g.w)(o=>r.pay(o)))}getAllSubscriptionPlans(){return(0,h.of)(this.subscriptionPlans).pipe(function K(n,i=y){const e=function L(n=0,i,e=N){let r=-1;return null!=i&&((0,B.K)(i)?e=i:r=i),new l.y(o=>{let s=function G(n){return n instanceof Date&&!isNaN(n)}(n)?+n-e.now():n;s<0&&(s=0);let d=0;return e.schedule(function(){o.closed||(o.next(d++),0<=r?this.schedule(void 0,r):o.complete())},s)})}(n,i);return C(()=>e)}(1e3))}getSubscriptionPlan(e){return new l.y(r=>{const o=this.subscriptionPlans.find(s=>s.duration_months===e);o?(r.next(o),r.complete()):r.error(new V(e))})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(X))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const H=function(n){return{"card shadow-md hover:shadow-lg scale-75 my-5":!0,"border-[5px] border-violet-500 scale-[1]":n}};let R=(()=>{class n{constructor(){this.active=!1,this.onChooseEvent=new t.vpe}choose(e){this.onChooseEvent.emit(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-subscription-card"]],inputs:{item:"item",active:"active"},outputs:{onChooseEvent:"onChooseEvent"},decls:24,vars:5,consts:[[3,"ngClass"],[1,"card-body","items-center"],[1,"card-title"],[1,"text-sm","text-gray-500"],[1,"avatar","placeholder"],[1,"bg-neutral-focus","text-neutral-content","rounded-full","w-[150px]"],[1,"text-3xl"],[1,"text-sm"],[1,"list-disc","list-inside","my-5"],[1,"btn","btn-primary","mt-4","w-full",3,"click"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._uU(2," Icon "),t.TgZ(3,"h2",2),t._uU(4),t.qZA(),t.TgZ(5,"span",3),t._uU(6,"Lorem ipsum"),t.qZA(),t.TgZ(7,"div",4)(8,"div",5)(9,"span",6),t._uU(10),t.TgZ(11,"span",7),t._uU(12,"/ GB"),t.qZA()()()(),t.TgZ(13,"ul",8)(14,"li"),t._uU(15,"Pay as you go Storage"),t.qZA(),t.TgZ(16,"li"),t._uU(17,"Unlimited Bandwidth"),t.qZA(),t.TgZ(18,"li"),t._uU(19,"10 Domains"),t.qZA(),t.TgZ(20,"li"),t._uU(21,"24/7 Support"),t.qZA()(),t.TgZ(22,"button",9),t.NdJ("click",function(){return r.choose(r.item.duration_months)}),t._uU(23,"Choisir"),t.qZA()()()),2&e&&(t.Q6J("ngClass",t.VKq(3,H,r.active)),t.xp6(4),t.hij("Basic ",r.item.duration_months," mois"),t.xp6(6),t.hij("$",r.item.price_usd_per_gb," "))},dependencies:[a.mk]}),n})();const b=function(n){return{step:!0,"step-primary":n}};let W=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-subscription-steps"]],inputs:{currentStep:"currentStep"},decls:7,vars:9,consts:[[1,"steps","w-full"],[3,"ngClass"]],template:function(e,r){1&e&&(t.TgZ(0,"ul",0)(1,"li",1),t._uU(2,"Abonnememnt"),t.qZA(),t.TgZ(3,"li",1),t._uU(4,"Paiement"),t.qZA(),t.TgZ(5,"li",1),t._uU(6,"Confirmation"),t.qZA()()),2&e&&(t.xp6(1),t.Q6J("ngClass",t.VKq(3,b,r.currentStep>=0)),t.xp6(2),t.Q6J("ngClass",t.VKq(5,b,r.currentStep>=1)),t.xp6(2),t.Q6J("ngClass",t.VKq(7,b,r.currentStep>=2)))},dependencies:[a.mk]}),n})();function tt(n,i){1&n&&(t.TgZ(0,"p"),t._uU(1,"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus lacinia odio vitae vestibulum vestibulum. Cras porttitor metus justo, ut fringilla nibh pretium a. Integer in tellus eu nisl consequat facilisis. Etiam at malesuada sapien, nec ullamcorper velit..."),t.qZA())}const et=function(){return[]};let nt=(()=>{class n{constructor(){this.checkerEvent=new t.vpe,this.isChecked=!1}toogleTerms(){this.isChecked=!this.isChecked,this.checkerEvent.emit(this.isChecked)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-subscription-term"]],outputs:{checkerEvent:"checkerEvent"},decls:9,vars:3,consts:[[1,"h-full","bg-white","p-6","shadow-md","rounded-md","terms-container","my-16"],[1,"text-3xl","font-bold","mb-10"],[1,"overflow-y-scroll","max-h-[500px]"],[4,"ngFor","ngForOf"],[1,"flex","my-5"],["type","checkbox","id","terms","value","true",1,"checkbox","checkbox-primary",3,"checked","change"],["for","terms",1,"ml-3"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Termes et Conditions d'abonnement"),t.qZA(),t.TgZ(3,"div",2),t.YNc(4,tt,2,0,"p",3),t.qZA(),t.TgZ(5,"div",4)(6,"input",5),t.NdJ("change",function(){return r.toogleTerms()}),t.qZA(),t.TgZ(7,"label",6),t._uU(8,"J'accepte les termes & conditions"),t.qZA()()()),2&e&&(t.xp6(4),t.Q6J("ngForOf",t.DdM(2,et).constructor(20)),t.xp6(2),t.Q6J("checked",r.isChecked))},dependencies:[a.sg]}),n})(),it=(()=>{class n{constructor(){this.backDisabled=!1,this.nextDisabled=!0,this.onAction=new t.vpe}go(e){this.onAction.emit(e)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-step-control"]],inputs:{backDisabled:"backDisabled",nextDisabled:"nextDisabled"},outputs:{onAction:"onAction"},decls:7,vars:2,consts:[[1,"flex","w-full","justify-between"],[1,"btn","btn-lg","btn-outline",3,"disabled","click"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0)(1,"div")(2,"button",1),t.NdJ("click",function(){return r.go(-1)}),t._uU(3,"Precedent"),t.qZA()(),t.TgZ(4,"div")(5,"button",1),t.NdJ("click",function(){return r.go(1)}),t._uU(6,"Suivant"),t.qZA()()()),2&e&&(t.xp6(2),t.Q6J("disabled",r.backDisabled),t.xp6(3),t.Q6J("disabled",r.nextDisabled))}}),n})(),rt=(()=>{class n{constructor(){this.totalPrice=new l.y,this.checkoutDisabled=!1}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-subscription-summary"]],inputs:{order:"order",totalPrice:"totalPrice",checkoutDisabled:"checkoutDisabled"},decls:25,vars:6,consts:[[1,"h-full"],[1,"card","shadow-lg","w-full","mx-4"],[1,"card-body"],[1,"card-title"],[1,"border-b","border-gray-200","py-4"],[1,"grid","grid-cols-2","my-4"],[1,""],[1,"text-right","font-bold","rounded-badge","badge-accent"],[1,"grid","grid-cols-2"],[1,"grid","grid-cols-2","py-4"],[1,"font-bold"],[1,"text-xl","text-right","font-bold"],[1,"btn","btn-primary","w-full",3,"disabled"]],template:function(e,r){1&e&&(t.TgZ(0,"div",0),t.ynx(1),t.TgZ(2,"div",1)(3,"div",2)(4,"h2",3),t._uU(5,"Resume de votre commande"),t.qZA(),t.TgZ(6,"div",4)(7,"div",5)(8,"span",6),t._uU(9,"Abonnement "),t.qZA(),t.TgZ(10,"span",7),t._uU(11),t.qZA()(),t.TgZ(12,"div",8)(13,"span"),t._uU(14,"Stockage "),t.qZA(),t.TgZ(15,"span",7),t._uU(16),t.qZA()()(),t.TgZ(17,"div",9)(18,"span",10),t._uU(19,"Total"),t.qZA(),t.TgZ(20,"span",11),t._uU(21),t.ALo(22,"async"),t.qZA()(),t.TgZ(23,"button",12),t._uU(24,"Valider"),t.qZA()()(),t.BQk(),t.qZA()),2&e&&(t.xp6(11),t.hij("",r.order.duration," mois"),t.xp6(5),t.hij("",r.order.storage," GB"),t.xp6(5),t.hij("$ ",t.lcZ(22,4,r.totalPrice),""),t.xp6(2),t.Q6J("disabled",r.checkoutDisabled))},dependencies:[a.Ov]}),n})();function ot(n,i){1&n&&(t.TgZ(0,"span",23),t._uU(1,"-10% sur la totalite"),t.qZA())}function st(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"app-subscription-card",24),t.NdJ("onChooseEvent",function(){const s=t.CHM(e).$implicit,d=t.oxw(4);return t.KtG(d.chooseSubscriptionDuration(s.duration_months))}),t.qZA()}if(2&n){const e=i.$implicit,r=t.oxw(3).ngIf;t.Q6J("active",r.duration===e.duration_months)("item",e)}}function ct(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",11)(2,"h3",12),t._uU(3,"Accompte ? "),t.YNc(4,ot,2,0,"span",13),t.qZA(),t.TgZ(5,"div")(6,"input",14),t.NdJ("change",function(){t.CHM(e);const o=t.oxw(2).ngIf,s=t.oxw();return t.KtG(s.changeSubscriptionUpfrontPayment(o.upfrontPayment))}),t.qZA()()(),t.TgZ(7,"div",15),t.YNc(8,st,1,2,"app-subscription-card",16),t.qZA(),t.TgZ(9,"div",17)(10,"h3",18),t._uU(11,"Ajuster la taille de stockage qui vous convient"),t.qZA(),t.TgZ(12,"select",19),t.NdJ("change",function(o){t.CHM(e);const s=t.oxw(3);return t.KtG(s.changeSubscriptionStorage(o))}),t.TgZ(13,"option",20),t._uU(14," 5 GB "),t.qZA(),t.TgZ(15,"option",21),t._uU(16," 10 GB "),t.qZA(),t.TgZ(17,"option",22),t._uU(18," 50 GB "),t.qZA()()()()}if(2&n){const e=i.ngIf,r=t.oxw(2).ngIf;t.xp6(4),t.Q6J("ngIf",r.upfrontPayment),t.xp6(4),t.Q6J("ngForOf",e)}}function ut(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"h3",9),t._uU(2,"Choisir votre plan d'abonnement"),t.qZA(),t.YNc(3,ct,19,2,"div",10),t.ALo(4,"async"),t.BQk()),2&n){const e=t.oxw(2),r=t.MAs(3);t.xp6(3),t.Q6J("ngIf",t.lcZ(4,2,e.subscriptionPlans$))("ngIfElse",r)}}function at(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",25)(2,"div",26)(3,"h2",27),t._uU(4,"Information de paiement"),t.qZA(),t.TgZ(5,"form",28)(6,"div",29)(7,"label",30)(8,"span",31),t._uU(9,"Numero"),t.qZA()(),t._UZ(10,"input",32),t.qZA(),t.TgZ(11,"div",33)(12,"div",29)(13,"label",30)(14,"span",31),t._uU(15,"Date d'expiration"),t.qZA()(),t._UZ(16,"input",34),t.qZA(),t.TgZ(17,"div",29)(18,"label",30)(19,"span",31),t._uU(20,"CVV"),t.qZA()(),t._UZ(21,"input",35),t.qZA()()()()(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(5),t.Q6J("formGroup",e.paymentForm)}}function lt(n,i){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-subscription-term",36),t.NdJ("checkerEvent",function(o){t.CHM(e);const s=t.oxw(2);return t.KtG(s.toogleChecker(o))}),t.qZA(),t.BQk()}}function pt(n,i){if(1&n){const e=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4),t._UZ(3,"app-subscription-steps",5),t.TgZ(4,"div"),t.YNc(5,ut,5,4,"ng-container",6),t.YNc(6,at,22,1,"ng-container",6),t.YNc(7,lt,2,0,"ng-container",6),t.qZA(),t.TgZ(8,"app-step-control",7),t.NdJ("onAction",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.updateStep(o))}),t.qZA()(),t._UZ(9,"app-subscription-summary",8),t.qZA()()}if(2&n){const e=i.ngIf,r=t.oxw();t.xp6(3),t.Q6J("currentStep",r.currentStep),t.xp6(2),t.Q6J("ngIf",0===r.currentStep),t.xp6(1),t.Q6J("ngIf",1===r.currentStep),t.xp6(1),t.Q6J("ngIf",2===r.currentStep),t.xp6(1),t.Q6J("backDisabled",0===r.currentStep)("nextDisabled",2===r.currentStep||1===r.currentStep&&r.paymentForm.invalid),t.xp6(1),t.Q6J("order",e)("checkoutDisabled",2!==r.currentStep||!r.termChecked)("totalPrice",r.totalPrice)}}function dt(n,i){1&n&&(t.TgZ(0,"span"),t._uU(1," Loading data... "),t.qZA())}const mt=[{path:"",component:(()=>{class n{constructor(e,r){this.subscriptionService=e,this.fb=r,this.subscriptionPlans$=new l.y,this.subscriptionOrder$=new l.y,this.currentStep=0,this.totalPrice=(0,h.of)(0),this.termChecked=!1}ngOnInit(){this.getSubscriptionPlans(),this.listenToOrderChange(),this.listenToPriceChange(),this.paymentForm=this.fb.group({cvv:["",[u.kI.required,u.kI.minLength(3),u.kI.maxLength(3)]],expirationDate:["",u.kI.required],number:["",[u.kI.required,Z]]})}listenToOrderChange(){this.subscriptionOrder$=this.subscriptionService.currentOrder()}listenToPriceChange(){this.totalPrice=this.subscriptionOrder$.pipe((0,g.w)(e=>this.subscriptionService.calculatePrice(e)))}getSubscriptionPlans(){this.subscriptionPlans$=this.subscriptionService.getAllSubscriptionPlans()}chooseSubscriptionDuration(e){this.subscriptionService.updateOrder({duration:e})}changeSubscriptionStorage({target:e}){this.subscriptionService.updateOrder({storage:Number(e.value)})}changeSubscriptionUpfrontPayment(e){this.subscriptionService.updateOrder({upfrontPayment:!e})}confirmPayment(){this.subscriptionOrder$.pipe((0,f.U)(e=>e),(0,g.w)(e=>this.subscriptionService.processOrder(e,new T({...this.paymentForm.value}))))}updateStep(e){this.currentStep+=e}toogleChecker(e){this.termChecked=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(z),t.Y36(u.qu))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-subscription"]],decls:4,vars:3,consts:[["class","w-full h-full px-20 py-16",4,"ngIf"],["loading",""],[1,"w-full","h-full","px-20","py-16"],[1,"grid","xl:grid-cols-2/3","grid-cols-1","gap-4","h-full"],[1,"h-full","flex","flex-col","justify-between"],[1,"mx-5",3,"currentStep"],[4,"ngIf"],[3,"backDisabled","nextDisabled","onAction"],[3,"order","checkoutDisabled","totalPrice"],[1,"text-3xl"],[4,"ngIf","ngIfElse"],[1,"flex","flex-col","justify-center","items-center","m-5"],[1,"text-2xl","font-bold","mb-3"],["class","text-error text-md font-600",4,"ngIf"],["type","checkbox",1,"toggle","toggle-lg",3,"change"],[1,"grid","grid-cols-1","xl:grid-cols-3","justify-center","gap-8"],[3,"active","item","onChooseEvent",4,"ngFor","ngForOf"],[1,"my-10"],[1,"text-3xl","my-5"],[1,"select","select-success","w-full","max-w-xs",3,"change"],["value","5"],["value","10"],["value","50"],[1,"text-error","text-md","font-600"],[3,"active","item","onChooseEvent"],[1,"card","shadow-lg","mx-auto","w-full","md:w-1/2"],[1,"card-body"],[1,"card-title"],[1,"my-10",3,"formGroup"],[1,"form-control"],[1,"label"],[1,"label-text"],["type","text","placeholder","4242 4242 4242 4242","formControlName","number",1,"input","input-bordered"],[1,"grid","grid-cols-2","gap-4"],["type","date","placeholder","MM/YY","formControlName","expirationDate",1,"input","input-bordered"],["type","text","placeholder","123","formControlName","cvv",1,"input","input-bordered"],[3,"checkerEvent"]],template:function(e,r){1&e&&(t.YNc(0,pt,10,9,"div",0),t.ALo(1,"async"),t.YNc(2,dt,2,0,"ng-template",null,1,t.W1O)),2&e&&t.Q6J("ngIf",t.lcZ(1,1,r.subscriptionOrder$))},dependencies:[a.sg,a.O5,u._Y,u.YN,u.Kr,u.Fj,u.JJ,u.JL,u.sg,u.u,R,W,nt,it,rt,a.Ov]}),n})()}];let ht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[_.Bz.forChild(mt),_.Bz]}),n})(),gt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[a.ez,ht,u.UX]}),n})()}}]);